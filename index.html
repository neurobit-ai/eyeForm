<!doctype html>
<html lang="zh-Hant-TW">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- <link href="https://fonts.googleapis.com/css?family=Oswald:300,400|Roboto+Mono&display=swap" rel="stylesheet"> -->

    <!-- <link rel="stylesheet" href="fonts/icomoon/style.css"> -->


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.513.min.css">
    
    <!-- Style -->
    <link rel="stylesheet" href="css/style.css">

    <script src="https://use.fontawesome.com/releases/v6.1.2/js/all.js" crossorigin="anonymous"></script>

    <title>eyeForm</title>
  </head>
  <body class="bg-light">

  <div class="content">
    
    <div class="container">
      <i class="fa-solid fa-1"></i>
      <script src="js/jwt-decode.js"></script>
      <script src="https://accounts.google.com/gsi/client" async defer></script>
      <script>
        function handleCredentialResponse(response) {
          var token = response.credential;
          var decoded = jwt_decode(token);
          console.log(decoded.name);
          console.log(decoded.email);
          document.getElementById('name').value = decoded.name;
          document.getElementById('email').value = decoded.email;
        }
        window.onload = function () {
          google.accounts.id.initialize({
            client_id: "654169467066-m7pbsg18jglpe45uqvqtq8hopsph4i8k.apps.googleusercontent.com",
            callback: handleCredentialResponse
          });
          google.accounts.id.renderButton(
            document.getElementById("buttonDiv"),
            { theme: "filled_blue", size: "large" }  // customization attributes
          );
          google.accounts.id.prompt(); // also display the One Tap dialog
        }
      </script>
      <div class="row">
        <div class="col-6 form-group">
          <div id="buttonDiv"></div>
        </div>
        <div class="col-3 form-group">
        </div>
        <div class="col-3 form-group form-check form-switch">
          <input class="form-check-input" type="checkbox" id="darkMode">
          <label class="form-check-label" for="darkMode">深色模式</label>
        </div>
      </div>
      <br>
      <script>
        var darkMode = document.getElementById('darkMode');
        darkMode.onclick = function() {
          if (darkMode.checked) {
            document.body.classList.remove('bg-light');
            document.body.classList.add('bg-dark');
            document.body.classList.add('text-light');
          } else {
            document.body.classList.remove('bg-dark');
            document.body.classList.remove('text-light');
            document.body.classList.add('bg-light');
          }
        };
      </script>

      <!-- <div class="row justify-content-center"> -->
        <!-- <div class="col-12"> -->

          <div class="row justify-content-center">
            <div class="col-12">
              
              <!-- <h3 class="thin-heading mb-4">eyeForm</h3> -->

              <form method="post" id="contactForm" name="contactForm">
                <input type="hidden" name="name" id="name">
                <input type="hidden" name="email" id="email">

                <i class="fa-solid fa-2"></i>
                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="medRecNo">病歷號</label>
                    <input type="text" class="form-control" name="medRecNo" id="medRecNo">
                  </div>
                  <div class="col-3 form-group">
                    <label class="form-label" for="site">院所</label>
                    <select class="form-select" name="site" id="site">
                      <option value=""></option>
                      <option value="三總">三總</option>
                      <option value="皓明" disabled>皓明</option>
                    </select>
                  </div>
                  <div class="col-3 form-group">
                    <label class="form-label" for="caseNo">案號</label>
                    <input type="number" class="form-control" name="caseNo" id="caseNo" disabled>
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="dateOfVisit">就診西元年/月/日</label>
                    <input type="date" class="form-control" name="dateOfVisit" id="dateOfVisit">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="dateOfBirth">出生西元年/月/日</label>
                    <input type="date" class="form-control" name="dateOfBirth" id="dateOfBirth">
                  </div>
                </div>

                <div class="row">
                  <div class="col-3 form-group">
                    <label class="form-label" for="age">實歲</label>
                    <input type="text" class="form-control" name="age" id="age" disabled>
                  </div>
                  <div class="col-3 form-group">
                    <label class="form-label" for="height">身高(cm)</label>
                    <input type="number" min=1 step=0.1 class="form-control" name="height" id="height">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="pretermW">早產週數</label>
                    <div class="row g-0">
                      <div class="col-5 form-group">
                        <input type="number" min=0 step=1 class="form-control" name="pretermW" id="pretermW">
                      </div>
                      <div class="col-1 form-group">
                        <label class="form-label" for="pretermW">週</label>
                      </div>
                      <div class="col-5 form-group">
                        <input type="number" min=0 step=1 max=6 class="form-control" name="pretermD" id="pretermD">
                      </div>
                      <div class="col-1 form-group">
                        <label class="form-label" for="pretermD">天</label>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label">性別</label>
                    <br>　
                    <input type="radio" class="form-check-input" name="sex" id="sexM" value="男">
                    <label class="form-label" for="sexM">男　</label>
                    <input type="radio" class="form-check-input" name="sex" id="sexF" value="女">
                    <label class="form-label" for="sexF">女　</label>
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label">胎別</label>
                    <br>　
                    <input type="radio" class="form-check-input" name="birth" id="birth" value="單">
                    <label class="form-label" for="birth">單　</label>
                    <input type="radio" class="form-check-input" name="birth" id="births" value="多">
                    <label class="form-label" for="births">多　</label>
                  </div>
                </div>

                <br>
                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="fatherD">父：近視度數 ≦ -5D</label>
                    <input type="number" max=-5 step=0.5 class="form-control" name="fatherD" id="fatherD">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="motherD">母：近視度數 ≦ -5D</label>
                    <input type="number" max=-5 step=0.5 class="form-control" name="motherD" id="motherD">
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="od1">右眼最佳矯正視力<span class="form-range-value" id="od1value"></span></label>
                    <label class="form-label" for="od0">戴眼鏡</label>
                    <input type="checkbox" class="form-check-input" name="od0" id="od0" value="G">
                    <input type="range" class="form-range" min=0 max=1 step=0.1 name="od1" id="od1">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="os1">左眼最佳矯正視力<span class="form-range-value" id="os1value"></span></label>
                    <label class="form-label" for="os0">戴眼鏡</label>
                    <input type="checkbox" class="form-check-input" name="os0" id="os0" value="G">
                    <input type="range" class="form-range" min=0 max=1 step=0.1 name="os1" id="os1">
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="od2">右眼球面度數 <span class="form-range-value" id="od2value"></span></label>
                    <input type="range" class="form-range" min=-10 max=10 step=0.25 name="od2" id="od2">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="os2">左眼球面度數 <span class="form-range-value" id="os2value"></span></label>
                    <input type="range" class="form-range" min=-10 max=10 step=0.25 name="os2" id="os2">
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="od3">右眼散光度數 <span class="form-range-value" id="od3value"></span></label>
                    <input type="range" class="form-range" min=-7 max=0 step=0.25 name="od3" id="od3">
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="os3">左眼散光度數 <span class="form-range-value" id="os3value"></span></label>
                    <input type="range" class="form-range" min=-7 max=0 step=0.25 name="os3" id="os3">
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="od4">右眼軸度</label>
                    <select class="form-select" name="od4" id="od4">
                      <option value=""></option>
                      <optgroup label="常見">
                        <option value="0">0</option>
                        <option value="90">90</option>
                        <option value="180">180</option>
                        <option value="10">10</option>
                        <option value="170">170</option>
                        <option value="20">20</option>
                        <option value="160">160</option>
                      </optgroup>
                      <optgroup label="------------------------------------------------">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                        <option value="105">105</option>
                        <option value="110">110</option>
                        <option value="115">115</option>
                        <option value="120">120</option>
                        <option value="125">125</option>
                        <option value="130">130</option>
                        <option value="135">135</option>
                        <option value="140">140</option>
                        <option value="145">145</option>
                        <option value="150">150</option>
                        <option value="155">155</option>
                        <option value="160">160</option>
                        <option value="165">165</option>
                        <option value="170">170</option>
                        <option value="175">175</option>
                      </optgroup>
                    </select>
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="os4">左眼軸度</label>
                    <select class="form-select" name="os4" id="os4">
                      <option value=""></option>
                      <optgroup label="常見">
                        <option value="0">0</option>
                        <option value="90">90</option>
                        <option value="180">180</option>
                        <option value="10">10</option>
                        <option value="170">170</option>
                        <option value="20">20</option>
                        <option value="160">160</option>
                      </optgroup>
                      <optgroup label="------------------------------------------------">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                        <option value="60">60</option>
                        <option value="65">65</option>
                        <option value="70">70</option>
                        <option value="75">75</option>
                        <option value="80">80</option>
                        <option value="85">85</option>
                        <option value="90">90</option>
                        <option value="95">95</option>
                        <option value="100">100</option>
                        <option value="105">105</option>
                        <option value="110">110</option>
                        <option value="115">115</option>
                        <option value="120">120</option>
                        <option value="125">125</option>
                        <option value="130">130</option>
                        <option value="135">135</option>
                        <option value="140">140</option>
                        <option value="145">145</option>
                        <option value="150">150</option>
                        <option value="155">155</option>
                        <option value="160">160</option>
                        <option value="165">165</option>
                        <option value="170">170</option>
                        <option value="175">175</option>
                      </optgroup>
                    </select>
                  </div>
                </div>

                <div class="row">
                  <div class="col-6 form-group">
                    <label class="form-label" for="od5int">右眼軸長(mm)</label>
                    <div class="row g-0">
                      <div class="col-6 form-group">
                        <select class="form-select" name="od5int" id="od5int">
                          <option value=""></option>
                          <option value="< 20">< 20</option>
                          <option value="20">20</option>
                          <option value="21">21</option>
                          <option value="22">22</option>
                          <option value="23">23</option>
                          <option value="24">24</option>
                          <option value="25">25</option>
                          <option value="26">26</option>
                          <option value="27">27</option>
                          <option value="28">28</option>
                          <option value="29">29</option>
                          <option value="30">30</option>
                          <option value="> 30">> 30</option>
                        </select>
                      </div>
                      <div class="col-6 form-group">
                        <select class="form-select" name="od5dec" id="od5dec">
                          <option value=".00">.00</option>
                          <option value=".01">.01</option>
                          <option value=".02">.02</option>
                          <option value=".03">.03</option>
                          <option value=".04">.04</option>
                          <option value=".05">.05</option>
                          <option value=".06">.06</option>
                          <option value=".07">.07</option>
                          <option value=".08">.08</option>
                          <option value=".09">.09</option>
                          <option value=".10">.10</option>
                          <option value=".11">.11</option>
                          <option value=".12">.12</option>
                          <option value=".13">.13</option>
                          <option value=".14">.14</option>
                          <option value=".15">.15</option>
                          <option value=".16">.16</option>
                          <option value=".17">.17</option>
                          <option value=".18">.18</option>
                          <option value=".19">.19</option>
                          <option value=".20">.20</option>
                          <option value=".21">.21</option>
                          <option value=".22">.22</option>
                          <option value=".23">.23</option>
                          <option value=".24">.24</option>
                          <option value=".25">.25</option>
                          <option value=".26">.26</option>
                          <option value=".27">.27</option>
                          <option value=".28">.28</option>
                          <option value=".29">.29</option>
                          <option value=".30">.30</option>
                          <option value=".31">.31</option>
                          <option value=".32">.32</option>
                          <option value=".33">.33</option>
                          <option value=".34">.34</option>
                          <option value=".35">.35</option>
                          <option value=".36">.36</option>
                          <option value=".37">.37</option>
                          <option value=".38">.38</option>
                          <option value=".39">.39</option>
                          <option value=".40">.40</option>
                          <option value=".41">.41</option>
                          <option value=".42">.42</option>
                          <option value=".43">.43</option>
                          <option value=".44">.44</option>
                          <option value=".45">.45</option>
                          <option value=".46">.46</option>
                          <option value=".47">.47</option>
                          <option value=".48">.48</option>
                          <option value=".49">.49</option>
                          <option value=".50">.50</option>
                          <option value=".51">.51</option>
                          <option value=".52">.52</option>
                          <option value=".53">.53</option>
                          <option value=".54">.54</option>
                          <option value=".55">.55</option>
                          <option value=".56">.56</option>
                          <option value=".57">.57</option>
                          <option value=".58">.58</option>
                          <option value=".59">.59</option>
                          <option value=".60">.60</option>
                          <option value=".61">.61</option>
                          <option value=".62">.62</option>
                          <option value=".63">.63</option>
                          <option value=".64">.64</option>
                          <option value=".65">.65</option>
                          <option value=".66">.66</option>
                          <option value=".67">.67</option>
                          <option value=".68">.68</option>
                          <option value=".69">.69</option>
                          <option value=".70">.70</option>
                          <option value=".71">.71</option>
                          <option value=".72">.72</option>
                          <option value=".73">.73</option>
                          <option value=".74">.74</option>
                          <option value=".75">.75</option>
                          <option value=".76">.76</option>
                          <option value=".77">.77</option>
                          <option value=".78">.78</option>
                          <option value=".79">.79</option>
                          <option value=".80">.80</option>
                          <option value=".81">.81</option>
                          <option value=".82">.82</option>
                          <option value=".83">.83</option>
                          <option value=".84">.84</option>
                          <option value=".85">.85</option>
                          <option value=".86">.86</option>
                          <option value=".87">.87</option>
                          <option value=".88">.88</option>
                          <option value=".89">.89</option>
                          <option value=".90">.90</option>
                          <option value=".91">.91</option>
                          <option value=".92">.92</option>
                          <option value=".93">.93</option>
                          <option value=".94">.94</option>
                          <option value=".95">.95</option>
                          <option value=".96">.96</option>
                          <option value=".97">.97</option>
                          <option value=".98">.98</option>
                          <option value=".99">.99</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 form-group">
                    <label class="form-label" for="os5int">左眼軸長(mm)</label>
                    <div class="row g-0">
                      <div class="col-6 form-group">
                        <select class="form-select" name="os5int" id="os5int">
                          <option value=""></option>
                          <option value="< 20">< 20</option>
                          <option value="20">20</option>
                          <option value="21">21</option>
                          <option value="22">22</option>
                          <option value="23">23</option>
                          <option value="24">24</option>
                          <option value="25">25</option>
                          <option value="26">26</option>
                          <option value="27">27</option>
                          <option value="28">28</option>
                          <option value="29">29</option>
                          <option value="30">30</option>
                          <option value="> 30">> 30</option>
                        </select>
                      </div>
                      <div class="col-6 form-group">
                        <select class="form-select" name="os5dec" id="os5dec">
                          <option value=".00">.00</option>
                          <option value=".01">.01</option>
                          <option value=".02">.02</option>
                          <option value=".03">.03</option>
                          <option value=".04">.04</option>
                          <option value=".05">.05</option>
                          <option value=".06">.06</option>
                          <option value=".07">.07</option>
                          <option value=".08">.08</option>
                          <option value=".09">.09</option>
                          <option value=".10">.10</option>
                          <option value=".11">.11</option>
                          <option value=".12">.12</option>
                          <option value=".13">.13</option>
                          <option value=".14">.14</option>
                          <option value=".15">.15</option>
                          <option value=".16">.16</option>
                          <option value=".17">.17</option>
                          <option value=".18">.18</option>
                          <option value=".19">.19</option>
                          <option value=".20">.20</option>
                          <option value=".21">.21</option>
                          <option value=".22">.22</option>
                          <option value=".23">.23</option>
                          <option value=".24">.24</option>
                          <option value=".25">.25</option>
                          <option value=".26">.26</option>
                          <option value=".27">.27</option>
                          <option value=".28">.28</option>
                          <option value=".29">.29</option>
                          <option value=".30">.30</option>
                          <option value=".31">.31</option>
                          <option value=".32">.32</option>
                          <option value=".33">.33</option>
                          <option value=".34">.34</option>
                          <option value=".35">.35</option>
                          <option value=".36">.36</option>
                          <option value=".37">.37</option>
                          <option value=".38">.38</option>
                          <option value=".39">.39</option>
                          <option value=".40">.40</option>
                          <option value=".41">.41</option>
                          <option value=".42">.42</option>
                          <option value=".43">.43</option>
                          <option value=".44">.44</option>
                          <option value=".45">.45</option>
                          <option value=".46">.46</option>
                          <option value=".47">.47</option>
                          <option value=".48">.48</option>
                          <option value=".49">.49</option>
                          <option value=".50">.50</option>
                          <option value=".51">.51</option>
                          <option value=".52">.52</option>
                          <option value=".53">.53</option>
                          <option value=".54">.54</option>
                          <option value=".55">.55</option>
                          <option value=".56">.56</option>
                          <option value=".57">.57</option>
                          <option value=".58">.58</option>
                          <option value=".59">.59</option>
                          <option value=".60">.60</option>
                          <option value=".61">.61</option>
                          <option value=".62">.62</option>
                          <option value=".63">.63</option>
                          <option value=".64">.64</option>
                          <option value=".65">.65</option>
                          <option value=".66">.66</option>
                          <option value=".67">.67</option>
                          <option value=".68">.68</option>
                          <option value=".69">.69</option>
                          <option value=".70">.70</option>
                          <option value=".71">.71</option>
                          <option value=".72">.72</option>
                          <option value=".73">.73</option>
                          <option value=".74">.74</option>
                          <option value=".75">.75</option>
                          <option value=".76">.76</option>
                          <option value=".77">.77</option>
                          <option value=".78">.78</option>
                          <option value=".79">.79</option>
                          <option value=".80">.80</option>
                          <option value=".81">.81</option>
                          <option value=".82">.82</option>
                          <option value=".83">.83</option>
                          <option value=".84">.84</option>
                          <option value=".85">.85</option>
                          <option value=".86">.86</option>
                          <option value=".87">.87</option>
                          <option value=".88">.88</option>
                          <option value=".89">.89</option>
                          <option value=".90">.90</option>
                          <option value=".91">.91</option>
                          <option value=".92">.92</option>
                          <option value=".93">.93</option>
                          <option value=".94">.94</option>
                          <option value=".95">.95</option>
                          <option value=".96">.96</option>
                          <option value=".97">.97</option>
                          <option value=".98">.98</option>
                          <option value=".99">.99</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>

                <i class="fa-solid fa-3"></i>
                <div class="row">
                  <div class="col-9 form-group">
                    <input type="radio" class="form-check-input" name="treatment" id="treatmentN" value="N" checked>
                    <label class="form-label" for="treatmentN">未治療或觀察　</label>
                    <input type="radio" class="form-check-input" name="treatment" id="treatmentY" value="Y">
                    <label class="form-label" for="treatmentY">治療處置　</label>
                  </div>
                </div>
                <br>
                <div class="row g-2">
                  <div class="col-4 form-group">
                    <label class="form-label" for="treatment1">眼鏡</label>
                    <select class="form-select" name="treatment1" id="treatment1" disabled>
                      <option value=""></option>
                      <option value="一般眼鏡">一般眼鏡</option>
                      <option value="近視控制眼鏡_Zeiss_MyoVision">近視控制眼鏡_Zeiss_MyoVision</option>
                      <option value="近視控制眼鏡_Hoya_MiyoSmart">近視控制眼鏡_Hoya_MiyoSmart</option>
                      <option value="近視控制眼鏡_依視路_星趣控">近視控制眼鏡_依視路_星趣控</option>
                      <option value="近視控制隱形眼鏡_酷柏_MiSight">近視控制隱形眼鏡_酷柏_MiSight</option>
                    </select>
                  </div>
                  <div class="col-4 form-group">
                    <label class="form-label" for="treatment2">散瞳劑</label>
                    <select class="form-select" name="treatment2" id="treatment2" disabled>
                      <option value=""></option>
                      <option value="短效">短效</option>
                      <option value="0.01%">0.01%</option>
                      <option value="0.02%">0.02%</option>
                      <option value="0.03%">0.03%</option>
                      <option value="0.05%">0.05%</option>
                      <option value="0.1%">0.1%</option>
                      <option value="0.3%">0.3%</option>
                      <option value="0.5%">0.5%</option>
                      <option value="1.0%">1.0%</option>
                    </select>
                  </div>
                  <div class="col-4 form-group">
                    <label class="form-label" for="treatment3">角膜塑型片</label>
                    <select class="form-select" name="treatment3" id="treatment3" disabled>
                      <option value=""></option>
                      <option value="角膜塑型片">角膜塑型片</option>
                    </select>
                  </div>
                </div>

                <i class="fa-solid fa-4"></i>
                <div class="row">
                  <div class="col-3 form-group">
                    <input type="submit" id="submit" value="上傳" class="btn btn-outline-primary btn-rounded py-0 px-4">
                    <span class="submitting"></span>
                  </div>
                </div>

              </form>

              <div id="form-message-warning mt-4"></div> 
              <div id="form-message-success">
                上傳完畢！
              </div>

            </div>
          </div>
        <!-- </div> -->
      <!-- </div> -->
    </div>

  </div>
    
  <script>
    var medRecNo = document.getElementById("medRecNo");
    medRecNo.onclick = function() {
      document.getElementById('site').value = '';
      document.getElementById('caseNo').value = '';
    }

    var site = document.getElementById("site");
    site.onchange = function() {
      if (document.getElementById('email').value)
      $.ajax({
        url: `https://script.google.com/macros/s/AKfycbxQ9syZwsCKqV-VomQu41ttXrDAlbraWhkM1tUjoRM-_Xt-01Lh1jL4MssVDRmh2EX4hw/exec?medRecNo=${medRecNo.value}&site=${site.value}`,
        type: 'GET',
        dataType: 'json',
        success: function(data) {
          if (typeof data === 'object') {
            document.getElementById('caseNo').value = data[0][0];
            document.getElementById('dateOfBirth').value = new Date(Date.parse(data[0][2])+8*60*60*1000).toISOString().split('T')[0];
            document.getElementById('dateOfVisit').value = new Date(Date.parse(data[0][10])+8*60*60*1000).toISOString().split('T')[0];
            document.getElementById('age').value = data[0][11];
            document.getElementById('height').value = data[0][12];
            document.getElementById('pretermW').value = data[0][6];
            document.getElementById('pretermD').value = data[0][7];
            if (data[0][3] == '男')
              document.getElementById('sexM').checked = true;
            if (data[0][3] == '女')
              document.getElementById('sexF').checked = true;
            if (data[0][4] == '單')
              document.getElementById('birth').checked = true;
            if (data[0][4] == '多')
              document.getElementById('births').checked = true;
            document.getElementById('fatherD').value = data[0][8];
            document.getElementById('motherD').value = data[0][9];
            if (data[0][13] == 'G')
              document.getElementById('od0').checked = true;
            document.getElementById('od1').value = data[0][14];
            document.getElementById('od2').value = data[0][15];
            document.getElementById('od3').value = data[0][16];
            document.getElementById('od4').value = data[0][17];
            document.getElementById('od5int').value = parseInt(data[0][18]);
            document.getElementById('od5dec').value = (data[0][18] - parseInt(data[0][18])).toFixed(2).toString().substring(1);
            if (data[0][19] == 'G')
              document.getElementById('os0').checked = true;
            document.getElementById('os1').value = data[0][20];
            document.getElementById('os2').value = data[0][21];
            document.getElementById('os3').value = data[0][22];
            document.getElementById('os4').value = data[0][23];
            document.getElementById('os5int').value = parseInt(data[0][24]);
            document.getElementById('os5dec').value = (data[0][24] - parseInt(data[0][24])).toFixed(2).toString().substring(1);
            outputs['od1value'].innerHTML = data[0][14].toFixed(1);
            outputs['od2value'].innerHTML = data[0][15].toFixed(2);
            outputs['od3value'].innerHTML = data[0][16].toFixed(2);
            outputs['os1value'].innerHTML = data[0][20].toFixed(1);
            outputs['os2value'].innerHTML = data[0][21].toFixed(2);
            outputs['os3value'].innerHTML = data[0][22].toFixed(2);
          }
          else
            document.getElementById('caseNo').value = data;
        }
      });
    }

    var dateOfVisit = document.getElementById('dateOfVisit');
    var dateOfBirth = document.getElementById('dateOfBirth');
    dateOfVisit.oninput = function() {
      if (!isNaN(Date.parse(dateOfVisit.value)) && !isNaN(Date.parse(dateOfBirth.value))) {
        var dov = dateOfVisit.value.split('-');
        var dob = dateOfBirth.value.split('-');
        var year = parseInt(dov[0]) - parseInt(dob[0]);
        var month = parseInt(dov[1]) - parseInt(dob[1]);
        console.log(year);
        console.log(month);
        if (parseInt(dov[2]) - parseInt(dob[2]) < 0) {
          month--;
        }
        if (month < 0) {
          year--;
          month += 12;
        }
        document.getElementById('age').value = year + '歲' + month + '個月';
      }
    }
    dateOfBirth.oninput = function() {
      if (!isNaN(Date.parse(dateOfVisit.value)) && !isNaN(Date.parse(dateOfBirth.value))) {
        var dov = dateOfVisit.value.split('-');
        var dob = dateOfBirth.value.split('-');
        var year = parseInt(dov[0]) - parseInt(dob[0]);
        var month = parseInt(dov[1]) - parseInt(dob[1]);
        console.log(year);
        console.log(month);
        if (parseInt(dov[2]) - parseInt(dob[2]) < 0) {
          month--;
        }
        if (month < 0) {
          year--;
          month += 12;
        }
        document.getElementById('age').value = year + '歲' + month + '個月';
      }
    }

    var sliders = document.getElementsByClassName("form-range");
    var outputs = document.getElementsByClassName("form-range-value");
    for (var i = 0; i < sliders.length; i++) {
      sliders[i].oninput = function() {
        var digits = 2;
        if(this.id[2] == 1) digits = 1;
        if(this.id[2] == 4) digits = 0;
        outputs[this.id+'value'].innerHTML = Number.parseFloat(this.value).toFixed(digits);
      }
    }
    
    var od5int = document.getElementById("od5int");
    od5int.onchange = function() {
      $('#od5dec').prop('disabled', (od5int.value >= 20 && od5int.value <= 30)?false:true);
    }
    var os5int = document.getElementById("os5int");
    os5int.onchange = function() {
      $('#os5dec').prop('disabled', (os5int.value >= 20 && os5int.value <= 30)?false:true);
    }

    var treatmentN = document.getElementById("treatmentN");
    treatmentN.onchange = function() {
      $('#treatment1').prop('disabled', (treatmentN.value == 'N')?true:false);
      $('#treatment2').prop('disabled', (treatmentN.value == 'N')?true:false);
      $('#treatment3').prop('disabled', (treatmentN.value == 'N')?true:false);
    }
    var treatmentY = document.getElementById("treatmentY");
    treatmentY.onchange = function() {
      $('#treatment1').prop('disabled', (treatmentY.value == 'Y')?false:true);
      $('#treatment2').prop('disabled', (treatmentY.value == 'Y')?false:true);
      $('#treatment3').prop('disabled', (treatmentY.value == 'Y')?false:true);
    }

    var submit = document.getElementById("submit");
    submit.onclick = function() {
      document.getElementById('age').disabled = false;
      document.getElementById('caseNo').disabled = false;
    }
  </script>
    

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/main.js"></script>

  </body>
</html>
